<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
<title>GFFI FLYNN ULTRA PRO</title>
<style>
*{margin:0;padding:0;touch-action:none;font-family:sans-serif}
html,body{overflow:hidden;background:#87ceeb;}
canvas{display:block;}

/* MENU */
#menu{
position:fixed;inset:0;
background:#000;color:white;
display:flex;flex-direction:column;
align-items:center;justify-content:center;
z-index:10;
}
.charbox{display:flex;gap:15px;margin-top:20px;}
.card{
width:110px;height:160px;
background:#111;border-radius:15px;
border:2px solid #333;
display:flex;flex-direction:column;
align-items:center;justify-content:center;
cursor:pointer;
transition:0.3s;
}
.card:hover{transform:scale(1.1);}
.card.active{border-color:orange}
.card img{width:90px}
button{
margin-top:30px;
padding:12px 30px;
font-size:18px;
background:orange;border:none;border-radius:20px;
cursor:pointer;
}

/* CONTROL */
#ctrl{
position:fixed;bottom:10px;width:100%;
display:flex;justify-content:space-between;
padding:0 20px;
}
.btn{
width:60px;height:60px;border-radius:50%;
background:rgba(255,255,255,.25);
display:flex;align-items:center;justify-content:center;
font-size:26px;
user-select:none;
}
</style>
</head>
<body>

<div id="menu">
<h1>üî• GFFI FLYNN ULTRA PRO üî•</h1>
<div class="charbox">
<div class="card" onclick="pick('asep',this)">
<img src="https://i.postimg.cc/kGN0dWNX/Proyek-Baru-7-E7C0DB8.png"><small>ASEP</small>
</div>
<div class="card" onclick="pick('farhan',this)">
<img src="https://i.postimg.cc/x8y1FJcL/file-000000008cbc7209ba95716b9ca5099c.png"><small>FARHAN</small>
</div>
<div class="card" onclick="pick('flynn',this)">
<img src="https://i.postimg.cc/J7Tgj7T5/Proyek-Baru-7-769B34B.png"><small>FLYNN</small>
</div>
</div>
<button onclick="startGame()">START</button>
</div>

<canvas id="c"></canvas>

<div id="ctrl">
<div>
<div class="btn" id="l">‚¨ÖÔ∏è</div>
<div class="btn" id="j">‚¨ÜÔ∏è</div>
</div>
<div>
<div class="btn" id="r">‚û°Ô∏è</div>
<div class="btn" id="s">üî•</div>
</div>
</div>

<script>
const c=document.getElementById("c"),ctx=c.getContext("2d");
let char=null;
let p={x:80,y:0,w:110,h:140,vy:0,hp:10,cd:true,direction:'right',frame:0};
let bullets=[],ghosts=[],boss=null,bossBullets=[],heals=[],explosions=[];
let score=0;
const ground=window.innerHeight-170,grav=0.7;
const cfg={asep:{c:1,d:4},farhan:{c:4,d:1},flynn:{c:3,d:2}};
let bgx1=0,bgx2=0;
let rightPressed=false,leftPressed=false;

// Images
const img={
bg1:new Image(),bg2:new Image(),
fire:new Image(),bossfire:new Image(),
asep:new Image(),farhan:new Image(),flynn:new Image(),
ghost:new Image(),boss:new Image(),heal:new Image(),
explosion:new Image()
};
img.bg1.src="https://i.postimg.cc/c1Q7NF3X/e20f2e831c750e780cc5a269add47e9.jpg";
img.bg2.src=img.bg1.src;
img.fire.src="https://i.postimg.cc/8c0NYRTc/a9ce9efff324a78bdf3905a15b227a7b.png";
img.bossfire.src=img.fire.src;
img.asep.src="https://i.postimg.cc/kGN0dWNX/Proyek-Baru-7-E7C0DB8.png";
img.farhan.src="https://i.postimg.cc/x8y1FJcL/file-000000008cbc7209ba95716b9ca5099c.png";
img.flynn.src="https://i.postimg.cc/J7Tgj7T5/Proyek-Baru-7-769B34B.png";
img.ghost.src="https://i.postimg.cc/6Q0zwzgS/Proyek-Baru-6-14E6F4A.png";
img.boss.src="https://i.postimg.cc/LXSXk3sq/Proyek-Baru-8-00EADCE.png";
img.heal.src="https://i.postimg.cc/8c0NYRTc/a9ce9efff324a78bdf3905a15b227a.png";
img.explosion.src="https://i.postimg.cc/3rQZ8pGp/explosion.png";

// Pick character
function pick(n,el){
char=n;
document.querySelectorAll(".card").forEach(c=>c.classList.remove("active"));
el.classList.add("active");
}

// HP Bar
function bar(x,y,hp,max){
ctx.fillStyle="red";
ctx.fillRect(x,y,50*(hp/max),6);
ctx.strokeStyle="white";
ctx.strokeRect(x,y,50,6);
}

// Spawn Ghost
function spawnGhost(){
setTimeout(()=>{
ghosts.push({x:c.width,y:ground,hp:3,fireCD:0});
spawnGhost();
},2000+Math.random()*2000);
}
// Spawn Boss
function spawnBoss(){
if(!boss) boss={x:c.width-200,y:ground-60,hp:9,cd:0,fireCD:0};
}

// Spawn Heal üíâ
function spawnHeal(){
setTimeout(()=>{
heals.push({x:Math.random()*(c.width-60),y:ground+40});
spawnHeal();
},5000+Math.random()*3000);
}

// Shoot
function shoot(){
if(!p.cd)return;
let g=cfg[char];
for(let i=0;i<g.c;i++){
setTimeout(()=>{bullets.push({x:p.x+90,y:p.y+70,d:g.d});},i*120);
}
p.cd=false;setTimeout(()=>p.cd=true,1000);
}

// Resize canvas
function resizeCanvas(){c.width=window.innerWidth;c.height=window.innerHeight;}
window.addEventListener("resize",resizeCanvas);
resizeCanvas();

// Start Game
function startGame(){
if(!char)return alert("Pilih karakter!");
document.getElementById("menu").style.display="none";
p.y=ground;
spawnGhost();
spawnHeal();
setInterval(spawnBoss,30000);
loop();
}

// Add explosion
function addExplosion(x,y){explosions.push({x,y,frame:0});}

// Main Loop
function loop(){
ctx.clearRect(0,0,c.width,c.height);

// Parallax background 2 layer
bgx1-=0.3; bgx2-=0.6;
ctx.drawImage(img.bg1,bgx1,0,c.width,c.height);
ctx.drawImage(img.bg1,bgx1+c.width,0,c.width,c.height);
ctx.drawImage(img.bg2,bgx2,0,c.width,c.height);
ctx.drawImage(img.bg2,bgx2+c.width,0,c.width,c.height);
if(bgx1<=-c.width)bgx1=0; if(bgx2<=-c.width)bgx2=0;

// Score
ctx.fillStyle="white"; ctx.font="20px Arial";
ctx.fillText("SCORE: "+score,20,30);

// Player physics
p.vy+=grav; p.y+=p.vy;
if(p.y>=ground){p.y=ground;p.vy=0;}

// Smooth move
if(rightPressed){p.x=Math.min(c.width-110,p.x+5); p.direction='right';}
if(leftPressed){p.x=Math.max(0,p.x-5); p.direction='left';}

// Player animation
p.frame=(p.frame+1)%8;
ctx.drawImage(img[char],p.x,p.y,p.w,p.h);
bar(p.x,p.y-10,p.hp,10);

// Game Over
if(p.hp<=0){
ctx.fillStyle="rgba(0,0,0,.7)";
ctx.fillRect(0,0,c.width,c.height);
ctx.fillStyle="red";
ctx.font="40px Arial";
ctx.fillText("GAME OVER",c.width/2-120,c.height/2);
return;
}

// Bullets
bullets.forEach((b,i)=>{
b.x+=10;
ctx.drawImage(img.fire,b.x,b.y,35,35);
});

// Ghosts
ghosts.forEach((g,i)=>{
g.x-=2;
ctx.drawImage(img.ghost,g.x,g.y,80,100);
bar(g.x,g.y-10,g.hp,3);
g.fireCD++;
if(g.fireCD>120){bossBullets.push({x:g.x,y:g.y+50}); g.fireCD=0;}
// hit player
if(g.x<p.x+p.w && g.x+80>p.x && g.y<p.y+p.h){p.hp--; ghosts.splice(i,1);}
bullets.forEach((b,bi)=>{
if(b.x<g.x+80 && b.x+35>g.x){g.hp-=b.d; addExplosion(b.x,b.y); bullets.splice(bi,1);}
});
if(g.hp<=0){score++; p.hp=Math.min(10,p.hp+1); ghosts.splice(i,1);}
});

// Boss
if(boss){
ctx.drawImage(img.boss,boss.x,boss.y,150,160);
bar(boss.x,boss.y-10,boss.hp,9);
boss.fireCD++;
if(boss.fireCD>60){
for(let k=0;k<3;k++) bossBullets.push({x:boss.x,y:boss.y+80,cd:k*15});
boss.fireCD=0;
}
bossBullets.forEach((bb,bi)=>{
bb.x-=6;
ctx.drawImage(img.bossfire,bb.x,bb.y,35,35);
if(bb.x<p.x+p.w){p.hp--;bossBullets.splice(bi,1);}
bb.cd--; if(bb.cd<0) bossBullets.splice(bi,1);
});
// hit boss
bullets.forEach((b,bi)=>{
if(b.x<boss.x+150 && b.x+35>boss.x){boss.hp-=b.d; addExplosion(b.x,b.y); bullets.splice(bi,1);}
});
if(boss.hp<=0){score+=3; p.hp=Math.min(10,p.hp+3); boss=null;}
}

// Heals üíâ
heals.forEach((h,i)=>{
ctx.drawImage(img.heal,h.x,h.y,40,40);
if(h.x<p.x+p.w && h.x+40>p.x && h.y<p.y+p.h){p.hp=Math.min(10,p.hp+2); heals.splice(i,1);}
});

// Explosions
explosions.forEach((e,i)=>{
ctx.globalAlpha=1-e.frame/10;
ctx.drawImage(img.explosion,e.x,e.y,40,40);
e.frame++;
if(e.frame>10) explosions.splice(i,1);
});
ctx.globalAlpha=1;

requestAnimationFrame(loop);
}

// Touch Controls smooth
const T=(id,f)=>{
let e=document.getElementById(id);
e.addEventListener("touchstart",x=>{x.preventDefault();f(true);});
e.addEventListener("touchend",x=>{x.preventDefault();f(false);});
};
T("l",v=>{leftPressed=v;});
T("r",v=>{rightPressed=v;});
T("j",v=>{if(v&&p.y>=ground)p.vy=-14});
document.getElementById("s").ontouchstart=e=>{e.preventDefault();shoot()};
</script>
</body>
</html>